{"name":"Scheduler Control","type":"virtual_device","properties":{"deviceIcon":1002,"currentIcon":"1002","mainLoop":"","saveLogs":"1","ui.lblActive.value":"WinterNormal","ui.lblRunning.value":"Next Run at 22:30:05","ui.lblState.value":"Active","rows":[{"type":"label","elements":[{"id":1,"lua":false,"waitForResponse":false,"caption":"Active Group","name":"lblActive","favourite":false,"main":false}]},{"type":"button","elements":[{"id":2,"lua":true,"waitForResponse":false,"caption":"Change Group","name":"btnGroup","empty":false,"msg":"groups =  groups or {SummerNormal = 1,\n  \t\t\t\t\tSummerHoliday = 2, \n\t\t\t\t\tWinterNormal = 3,\n\t\t\t\t\tWinterHoliday = 4}\n\ngroupsIndex =  groupsIndex or  {[1] = \"SummerNormal\",\n  \t\t\t\t\t[2] = \"SummerHoliday\", \n\t\t\t\t\t[3] = \"WinterNormal\",\n\t\t\t\t\t[4] = \"WinterHoliday\"}\n                                          \ndeviceID = deviceID or fibaro:getSelfId()\n\nlocal current = fibaro:getValue(deviceID, 'ui.lblActive.value')\n\nlocal currentID = groups[current] or 4\n\nif currentID == 4 then\n  currentID = 1\nelse\n  currentID = currentID + 1\nend\nfibaro:call(deviceID,\"setProperty\",\"ui.lblActive.value\", groupsIndex[currentID])","buttonIcon":1002,"favourite":false,"main":false}]},{"type":"label","elements":[{"id":3,"lua":false,"waitForResponse":false,"caption":"State","name":"lblState","favourite":false,"main":true}]},{"type":"button","elements":[{"id":4,"lua":true,"waitForResponse":false,"caption":"Set State","name":"btnState","empty":false,"msg":"groups =  groups or { Active = 1,\n  \t\t\t\t\tDisabled = 2 }\n\ngroupsIndex =  groupsIndex or  { [1] = \"Active\",\n  \t\t\t\t\t[2] = \"Disabled\"}\n                                          \ndeviceID = deviceID or fibaro:getSelfId()\n\nlocal current = fibaro:getValue(deviceID, 'ui.lblState.value')\n\nlocal currentID = groups[current] or 2\n\nif currentID == 2 then\n  currentID = 1\nelse\n  currentID = currentID + 1\nend\nfibaro:call(deviceID,\"setProperty\",\"ui.lblState.value\", groupsIndex[currentID])","buttonIcon":1002,"favourite":false,"main":false}]},{"type":"button","elements":[{"id":5,"lua":true,"waitForResponse":false,"caption":"Save","name":"btnSnape","empty":false,"msg":" deviceID = fibaro:getSelfId()\nactiveGroup = fibaro:get(deviceID,\"ui.lblActive.value\")  or \"WinterNormal\"\nactiveShedule = fibaro:get(deviceID,\"ui.lblState.value\") or \"Active\" \n\nfibaro:setGlobal(\"scheduleGroup\", activeGroup)\n\nfibaro:setGlobal(\"scheduleActive\", activeShedule)","buttonIcon":1002,"favourite":false,"main":true}]},{"type":"label","elements":[{"id":6,"lua":false,"waitForResponse":false,"caption":"Running","name":"lblRunning","favourite":false,"main":false}]}]},"actions":{"pressButton":1,"setSlider":2,"setProperty":2}}