{"name":"Alarm Clock","type":"virtual_device","properties":{"deviceIcon":1002,"currentIcon":"1002","mainLoop":"","saveLogs":"1","ui.lblDays.value":"Weekday","ui.lblTime.value":"06:00","rows":[{"type":"label","elements":[{"id":1,"lua":false,"waitForResponse":false,"caption":"Time","name":"lblTime","favourite":false,"main":true}]},{"type":"button","elements":[{"id":2,"lua":true,"waitForResponse":false,"caption":"+Hr","name":"btnHrUp","empty":false,"msg":"--[[\nAlarm for LUAScheduler for HC2 v1.2.9\noriginal by Ucciogenerale\ncontibutions from robmac + jompa68\n--]]\n\nlocal alarmClockDevice = fibaro:getSelfId()\n\nlocal newora = fibaro:get(alarmClockDevice,\"ui.lblTime.value\") \n\nif newora == \"\" then newora = \"00:00\" end\n\nlocal H = string.sub(newora, 1, 2) \nlocal M = string.sub(newora, 4, 5) \n\nif tonumber(H) < 23 \nthen \nH = tonumber(H) + 1 \nelse H = 0 \nend \n\nif string.len(H) < 2 \nthen H = string.format(\"%s%s\", '0', H) \nelse \nend \n\nnewora = string.format(\"%s:%s\", H, M) \n\nfibaro:call(alarmClockDevice,\"setProperty\",\"ui.lblTime.value\", newora)","buttonIcon":1002,"favourite":false,"main":true},{"id":3,"lua":true,"waitForResponse":false,"caption":"-Hr","name":"btnHrDn","empty":false,"msg":"local alarmClockDevice = fibaro:getSelfId()\n\nlocal newora = fibaro:get(alarmClockDevice,\"ui.lblTime.value\") \nlocal H = string.sub(newora, 1, 2) \nlocal M = string.sub(newora, 4, 5) \n\nif tonumber(H) > 0 \nthen \nH = tonumber(H) - 1 \nelse H = 23 \nend \n\nif string.len(H) < 2 \nthen H = string.format(\"%s%s\", '0', H) \nelse \nend \n\nnewora = string.format(\"%s:%s\", H, M) \n\nfibaro:call(alarmClockDevice,\"setProperty\",\"ui.lblTime.value\", newora)","buttonIcon":1002,"favourite":false,"main":false},{"id":4,"lua":true,"waitForResponse":false,"caption":"+Min","name":"btnMinUp","empty":false,"msg":"local alarmClockDevice = fibaro:getSelfId()\n\nlocal newora = fibaro:get(alarmClockDevice,\"ui.lblTime.value\") \nlocal H = string.sub(newora, 1, 2) \nlocal M = string.sub(newora, 4, 5) \n\nif tonumber(M) < 50 \nthen \nM = tonumber(M) + 10 \nelse M = 0 \nend \n\nif string.len(M) < 2 \nthen M = string.format(\"%s%s\", '0', M) \nelse \nend \n\nnewora = string.format(\"%s:%s\", H, M) \n\nfibaro:call(alarmClockDevice,\"setProperty\",\"ui.lblTime.value\", newora)\n","buttonIcon":1002,"favourite":false,"main":false},{"id":5,"lua":true,"waitForResponse":false,"caption":"-Min","name":"btnMinDn","empty":false,"msg":" local alarmClockDevice = fibaro:getSelfId()\n\nlocal newora = fibaro:get(alarmClockDevice,\"ui.lblTime.value\") \nlocal H = string.sub(newora, 1, 2) \nlocal M = string.sub(newora, 4, 5) \n\nif tonumber(M) > 0 \nthen \nM = tonumber(M) - 10 \nelse M = 50 \nend \n\nif string.len(M) < 2 \nthen M = string.format(\"%s%s\", '0', M) \nelse \nend \n\nnewora = string.format(\"%s:%s\", H, M) \n\nfibaro:call(alarmClockDevice,\"setProperty\",\"ui.lblTime.value\", newora)","buttonIcon":1002,"favourite":false,"main":false}]},{"type":"label","elements":[{"id":6,"lua":false,"waitForResponse":false,"caption":"Days","name":"lblDays","favourite":false,"main":false}]},{"type":"button","elements":[{"id":7,"lua":true,"waitForResponse":false,"caption":"Change Days","name":"btnDays","empty":false,"msg":"local alarmClockDevice = fibaro:getSelfId()\n\nlocal scheduleDays = {\n  [\"Sunday\"] = 1,\n  [\"Monday\"] = 2,\n  [\"Tuesday\"] = 3,\n  [\"Wednesday\"] = 4,\n  [\"Thursday\"] = 5,\n  [\"Friday\"] = 6,\n  [\"Saturday\"] = 7,\n  [\"All\"] = 8,\n  [\"Weekend\"] = 9,\n  [\"Weekday\"] = 10\n  }\n\nlocal daysSchedule = {\n  [1] = \"Sunday\",\n  [2]= \"Monday\",\n  [3]= \"Tuesday\",\n  [4]= \"Wednesday\",\n  [5] = \"Thursday\",\n  [6]= \"Friday\",\n  [7]= \"Saturday\",\n  [8]= \"All\",\n  [9] = \"Weekend\",\n  [10] = \"Weekday\"\n  }\n\nlocal newday = fibaro:get(alarmClockDevice,\"ui.lblDays.value\") \n\nif newday == \"\" then newday = \"All\" end\n\nfibaro:debug(newday)\n\nlocal D = scheduleDays[newday]\n\nfibaro:debug(D)\n\nif tonumber(D) < 10\nthen \nD = tonumber(D) + 1\nelse D = 1\nend \n\nfibaro:debug(D)\n\nnewday = daysSchedule[tonumber(D)]\n\nfibaro:call(alarmClockDevice,\"setProperty\",\"ui.lblDays.value\", newday)","buttonIcon":1002,"favourite":false,"main":false}]},{"type":"button","elements":[{"id":8,"lua":true,"waitForResponse":false,"caption":"Save","name":"btnSave","empty":false,"msg":"local alarmClockDevice = fibaro:getSelfId()\nlocal alarmClockTime = \"alarmTime1\"\nlocal alarmClockDay = \"alarmDays1\"\n\nlocal newora = fibaro:get(alarmClockDevice,\"ui.lblTime.value\") \n\nfibaro:setGlobal(alarmClockTime, newora)\n\nlocal newday = fibaro:get(alarmClockDevice,\"ui.lblDays.value\") \n\nfibaro:setGlobal(alarmClockDay, newday)","buttonIcon":1002,"favourite":false,"main":false}]}]},"actions":{"pressButton":1,"setSlider":2,"setProperty":2}}