{"name":"Lampa vänster","type":"virtual_device","properties":{"deviceIcon":1,"currentIcon":"70","log":"","logTemp":"","mainLoop":"local vDeviceID = fibaro:getSelfId()\nlocal NewStatus = fibaro:getValue(vDeviceID, \"ui.status.value\")\n\nfunction getIcon(sValue)\n  if(sValue == \"On\") then return 80\n    elseif(sValue == \"Off\") then return 70\n    elseif(sValue == nil) then return 81\n    else return 82\n  end\nend\n\nfunction setIcon(IconID)\n  fibaro:call(vDeviceID, \"setProperty\", \"currentIcon\", IconID)\nend\n\nlocal newIcon = getIcon(NewStatus)\nsetIcon(newIcon)\n\nfibaro:sleep(27*1000)","ui.status.value":"Off","visible":"true","rows":[{"type":"button","elements":[{"id":1,"lua":true,"waitForResponse":false,"caption":"On","name":"BtnOn","empty":false,"msg":"HC2 = Net.FHttp(\"10.0.16.32\", 8080) \nresponse, status, errorCode = HC2:GET(\"/json.htm?type=command&param=switchlight&idx=12&switchcmd=On&level=0\") \nfibaro:log(response)","buttonIcon":0,"favourite":false,"main":false},{"id":2,"lua":true,"waitForResponse":false,"caption":"Off","name":"BtnOff","empty":false,"msg":"HC2 = Net.FHttp(\"10.0.16.32\", 8080) \nresponse, status, errorCode = HC2:GET(\"/json.htm?type=command&param=switchlight&idx=12&switchcmd=Off&level=0\") \nfibaro:log(response)","buttonIcon":0,"favourite":false,"main":false}]},{"type":"button","elements":[{"id":3,"lua":true,"waitForResponse":false,"caption":"On/Off","name":"onoff","empty":false,"msg":"--[[\n%%properties\n%%globals\n]]--\n\nlocal vDeviceID = fibaro:getSelfId()\nlocal lightStatus = fibaro:getValue(vDeviceID, \"ui.status.value\")\n\nfunction getIcon(sValue)\n  if(sValue == \"On\") then return 80\n    elseif(sValue == \"Off\") then return 70\n    elseif(sValue == nil) then return 81\n    else return 82\n    end\n  end\n\nfunction setIcon(IconID)\n  fibaro:call(vDeviceID, \"setProperty\", \"currentIcon\", IconID)\n  end\n\n  \nif(lightStatus == \"On\") then\n\tHC2 = Net.FHttp(\"10.0.16.32\", 8080) \n\tresponse, status, errorCode = HC2:GET(\"/json.htm?type=command&param=switchlight&idx=12&switchcmd=Off&level=0\") \n\tfibaro:log(\"Av\")\n  else\n  \tHC2 = Net.FHttp(\"10.0.16.32\", 8080) \n\tresponse, status, errorCode = HC2:GET(\"/json.htm?type=command&param=switchlight&idx=12&switchcmd=On&level=0\") \n\tfibaro:log(\"På\")\nend\n\nlocal NewStatus = fibaro:getValue(vDeviceID, \"ui.status.value\")\nlocal newIcon = getIcon(NewStatus)\nsetIcon(newIcon)","buttonIcon":0,"favourite":false,"main":true}]},{"type":"label","elements":[{"id":4,"lua":false,"waitForResponse":false,"caption":"Status","name":"status","favourite":false,"main":false}]}]},"actions":{"pressButton":1,"setSlider":2,"setProperty":2}}